# LeadVertex плагин локализации
`\Leadvertex\Plugin\Components\Translations` - компонент, который призван помочь с локализацией вашего плагина на нужные языки.
Он использует [компонент symfony/console](https://symfony.com/doc/current/components/console.html "компонент symfony/console")
для консольных команд.

## Установка
```shell script
composer require leadvertex/plugin-component-translations
```

## Исспользование
### Быстрый старт
Этот плагин используется для облегчения добавления локализаций к вашему плагину.

- Прежде всего вам нужно определить язык по умолчанию для вашего плагина с помощью метода `Translator::config()`.\
  Язык по умолчанию - это язык, на котором написаны все строки в вашем плагине.\
  Эти строки будут использоваться как источник `source` для ваших переводов.
  
- Чтобы указать язык для перевода, вам нужно использовать метод `Translator::setLang()`.

- Чтобы получить строку переведенного текста, вам нужно использовать метод `Translator::get()`, в котором вам нужно указать `category` и` source`.
  Этот метод также позволяет создавать строки для перевода в ваших классах.
  Команды находят все ссылки на этот метод и создают для вас новый файл перевода с этими строками.

- Чтобы создать или обновить существующий перевод, вам нужно использовать `LangAddCommand` и` LangUpdateCommand` в вашем консольном приложении.
  LangAddCommand создаст новый файл перевода в каталоге `translations/`.
  В этом файле вы увидите все категории и `source` строк. Вы можете написать перевод строки в поле `translation`.

Когда все эти шаги выполнены, вы можете использовать компонент `Transaltor`, чтобы получить любой из ваших переводов.
Просто установите нужный язык с помощью метода `Translator::lang()` и получите переведенную строку с помощью метода `Translator::get()`.

### Конфигурация
Для настройки `Translator` вам нужно вызвать методы `config()` и `setLang()`, предоставить язык по умолчанию и установить
язык перевода.
```php
Translator::config('en_US'); // Установка языка по умолчанию / исходного языка как английского
Translator::setLang('ru_RU'); // Установка языка перевода как русского
```
Обратите внимание, что вам нужно использовать стандартный формат локали (`en_US`,` ru_RU` и т.д.).
Кроме того, метод `config` устанавливает текущий язык перевода таким же, как и по умолчанию.

Вы можете получить текущий язык `Translator`, установленный по умолчанию  с помощью метода `getDefaultLang()`и язык перевода с помощью метода `getLang()`.
Также вы можете получить массив всех ваших существующих языков перевода с помощью метода `getLanguages()`.

### Создание нового перевода
Чтобы установить строки для перевода, просто используйте `Translator::get('Категория', 'Строка для перевода')` в ваших классах. Все ссылки на `Translator::get()`
будет обнаружен `LangAddCommand` автоматически.\
Обратите внимание, что вы не можете использовать переменные для определения категории или строки источника.\
Простой пример:
```php
Translator::get('category', 'Source line 1');
Translator::get('category', 'Source line 2');
```
Для создания нового перевода вам нужно вызвать `LangAddCommand` в вашем консольном приложении.
Вы можете сделать это так:
```shell script
console.php lang:add ru_RU
```
Выполнение этой команды приведет к созданию нового файла перевода `ru_RU.json` в каталоге `translations/`.
Все файлы переводов имеют одну структуру:
```json
{
    "category": [ 
        {
            "source": "Source line 1",
            "translated": "Исходная строка 1"
        },
        {
            "source": "Source line 2",
            "translated": ""
        },
        ...
    ],
    "category 2": [ 
        ...
    ],
}
```
Все ваши строки, которые вы установили в своих классах, будут сгенерированы в этом файле как `source`. Чтобы установить перевод
вам просто нужно установить переведенную строку в поле `translation`.

### Обновление существующего перевода
Чтобы обновить перевод, вам нужно вызвать `LangUpdateCommand` в вашем консольном приложении.
Вы можете сделать это так:
```shell script
console.php lang:update
```

Если командный скрипт найдет какие-либо изменения в переводах в ваших классах, старые переводы будут сохранены в виде файлов `.old.json`.
Например, перевод `ru_RU.json` при обновлении будет переименован в `ru_RU.old.json`, а фактический перевод будет создан как обычный файл `ru_RU.json`.\
Обратите внимание, что эта команда обновит все существующие переводы сразу.

### Получение перевода
Чтобы получить перевод строки, вам нужно использовать метод `Translator::get()`. Если у вас нет перевода для
вызываемая строка, `Translator::get()` вернет исходное значение.\
Убедитесь, что вы установили нужный язык с помощью метода `Translator:setLang()`.\
Вы можете использовать это так:
```php
Translator::get('category', 'Source line 1'); // Will return a 'Исходная строка 1' as translation
Translator::get('category', 'Source line 2'); // Translation to this line os not set. Return value will be the source - 'Source line 2'
```

Также вы можете получить все строки перевода с категориями как объект [adbario/php-dot-notation](https://github.com/adbario/php-dot-notation "adbario/php-dot-notation").
Чтобы получить его, вам нужно использовать метод `load()`.\
Например, код для получения всех строк `ru_RU` будет выглядеть так:
```php
$ruTranslation = Translator::load('ru_RU');
```
